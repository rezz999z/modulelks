Hardening Document Host Information
echo "Unauthorized access is prohibited" > /etc/issue
echo "Unauthorized access is prohibited" > /etc/issue.net
sed -i 's/#Banner none/Banner \/etc\/issue.net/' /etc/ssh/sshd_config
chmod 644 /etc/issue /etc/issue.net
systemctl restart sshd

Closed Unusual Open Port
netstat -tulnp
firewall-cmd --permanent --remove-port=8080/tcp
firewall-cmd --reload

Hardening Whitelisting SELinux
semanage fcontext -a -t httpd_sys_content_t "/var/www/html(/.*)?"
restorecon -Rv /var/www/html
setsebool -P httpd_enable_homedirs on
setenforce 1 / vi /etc/selinux/config
sed -i 's/SELINUX=permissive/SELINUX=enforcing/g' /etc/selinux/config

Hardening CHROOT Shell
mkdir -p /chroot/{bin,lib64,dev,etc,home}
cp /bin/bash /chroot/bin/
cp -v /bin/{bash,ls,cat} /chroot/bin/

Hardening Certificate Shell Login
sed -i 's/#PasswordAuthentication yes/PasswordAuthentication no/' /etc/ssh/sshd_config
echo "AuthenticationMethods publickey" >> /etc/ssh/sshd_config
systemctl restart sshd

Hardening Directory Listing
yum install httpd
sed -i 's/Options Indexes FollowSymLinks/Options -Indexes/' /etc/httpd/conf/httpd.conf
systemctl restart httpd

Hardening Remote Command Execution
echo "ALL: ALL" >> /etc/hosts.deny
chmod 644 /etc/hosts.deny

Instalasi GnuPG (GPG) di CentOS 7
gpg --gen-key
gpg --list-keys
vi message.txt
Ini adalah pesan terenkripsi dan ditandatangani secara digital
gpg --armor --detach-sign message.txt
gpg --armor --encrypt --sign --recipient emailpenerima@gmail.com message.txt
gpg --decrypt message.txt.asc
gpg --verify message.txt.asc
yum install mutt -y
set pgp_sign_as = "pengirim@google.com"
set pgp_use_gpg = yes
set pgp_auto_sign = yes
mutt -s "Pesan Terenkripsi dan Ditandatangani" -e "set pgp_encrypt_as='pengirim@google.com'" -a message.txt.asc -- penerima@google.com < message.txt

openvpn
sudo yum install epel-release -y
sudo yum install openvpn easy-rsa -y
mkdir -p /etc/openvpn/easy-rsa
cp -r /usr/share/easy-rsa/3/* /etc/openvpn/easy-rsa/
cd /etc/openvpn/easy-rsa
./easyrsa init-pki
./easyrsa build-ca nopass
./easyrsa gen-req server nopass
./easyrsa sign-req server server
./easyrsa gen-dh
openvpn --genkey --secret /etc/openvpn/ta.key
cp pki/ca.crt pki/issued/server.crt pki/private/server.key pki/dh.pem /etc/openvpn/
cp /etc/openvpn/ta.key /etc/openvpn/
vi /etc/openvpn/server.conf
port 1194
proto udp
dev tun
ca /etc/openvpn/ca.crt
cert /etc/openvpn/server.crt
key /etc/openvpn/server.key
dh /etc/openvpn/dh.pem
server 10.8.0.0 255.255.255.0
push "redirect-gateway def1 bypass-dhcp"
push "dhcp-option DNS 8.8.8.8"
keepalive 10 120
tls-auth /etc/openvpn/ta.key 0
cipher AES-256-CBC
auth SHA256
persist-key
persist-tun
status /var/log/openvpn-status.log
log-append /var/log/openvpn.log
verb 3
systemctl start openvpn@server
systemctl enable openvpn@server
firewall-cmd --add-service=openvpn --permanent
firewall-cmd --add-masquerade --permanent
firewall-cmd --reload

Pembuatan Sertifikat untuk Client
cd /etc/openvpn/easy-rsa
./easyrsa gen-req client1 nopass
./easyrsa sign-req client client1
cp pki/ca.crt pki/issued/client1.crt pki/private/client1.key /etc/openvpn/client/
client
dev tun
proto udp
remote <server-ip> 1194
resolv-retry infinite
nobind
persist-key
persist-tun
ca ca.crt
cert client1.crt
key client1.key
tls-auth ta.key 1
cipher AES-256-CBC
auth SHA256
verb 3
openvpn --config /etc/openvpn/client/client.ovpn

Konfigurasi IDS
yum update
yum install gcc make flex bison libpcap libpcap-devel pcre pcre-devel libdnet libdnet-devel zlib zlib-devel -y
wget https://snort.org/downloads/snort/snort-2.9.18.1-1.el7.x86_64.rpm
rpm -ivh snort-2.9.18.1-1.el7.x86_64.rpm

[snort]
name=Snort
baseurl=https://www.snort.org/downloads/snort/snort-2.9.18.1-1.el7.x86_64.rpm
enabled=1
gpgcheck=0
yum --disablerepo=snort install snort -y
yum-config-manager --disable snort
subscription-manager repos --disable=snort
yum-config-manager --save --setopt=snort.skip_if_unavailable=true


systemctl start snort

sudo nano /etc/httpd/modsecurity.d/activated_rules/modsecurity_crs_21_protocol_anomalies.conf
grep "960017" /etc/httpd/modsecurity.d/activated_rules/*

