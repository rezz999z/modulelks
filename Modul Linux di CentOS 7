Hardening Document Host Information
echo "Unauthorized access is prohibited" > /etc/issue
echo "Unauthorized access is prohibited" > /etc/issue.net
sed -i 's/#Banner none/Banner \/etc\/issue.net/' /etc/ssh/sshd_config
chmod 644 /etc/issue /etc/issue.net
systemctl restart sshd


Closed Unusual Open Port
netstat -tulnp
firewall-cmd --permanent --remove-port=8080/tcp
firewall-cmd --reload

Hardening Whitelisting SELinux
semanage fcontext -a -t httpd_sys_content_t "/var/www/html(/.*)?"
restorecon -Rv /var/www/html
setsebool -P httpd_enable_homedirs on
setenforce 1 / vi /etc/selinux/config
sed -i 's/SELINUX=permissive/SELINUX=enforcing/g' /etc/selinux/config

Hardening CHROOT Shell
mkdir -p /chroot/{bin,lib64,dev,etc,home}
cp /bin/bash /chroot/bin/
cp -v /bin/{bash,ls,cat} /chroot/bin/

Hardening Certificate Shell Login
sed -i 's/#PasswordAuthentication yes/PasswordAuthentication no/' /etc/ssh/sshd_config
echo "AuthenticationMethods publickey" >> /etc/ssh/sshd_config
systemctl restart sshd

Hardening Directory Listing
yum install httpd
sed -i 's/Options Indexes FollowSymLinks/Options -Indexes/' /etc/httpd/conf/httpd.conf
systemctl restart httpd

Hardening Remote Command Execution
echo "ALL: ALL" >> /etc/hosts.deny
chmod 644 /etc/hosts.deny

Instalasi GnuPG (GPG) di CentOS 7
gpg --gen-key
gpg --list-keys
vi message.txt
Ini adalah pesan terenkripsi dan ditandatangani secara digital

gpg --armor --detach-sign message.txt
gpg --armor --encrypt --sign --recipient emailpenerima@gmail.com message.txt
gpg --decrypt message.txt.asc
gpg --verify message.txt.asc
yum install mutt -y
set pgp_sign_as = "pengirim@google.com"
set pgp_use_gpg = yes
set pgp_auto_sign = yes
mutt -s "Pesan Terenkripsi dan Ditandatangani" -e "set pgp_encrypt_as='pengirim@google.com'" -a message.txt.asc -- penerima@google.com < message.txt

openvpn
sudo yum install epel-release -y
sudo yum install openvpn easy-rsa -y
make-cadir ~/openvpn-ca
cd ~/openvpn-ca
cp /usr/share/doc/openvpn*/sample/sample-config-files/server.conf /etc/openvpn/
vi /etc/openvpn/server.conf

cd /openvpn-ca
vi vars
set_var EASYRSA_REQ_COUNTRY    "US"
set_var EASYRSA_REQ_PROVINCE   "California"
set_var EASYRSA_REQ_CITY       "San Francisco"
set_var EASYRSA_REQ_ORG        "MyOrg"
set_var EASYRSA_REQ_EMAIL      "admin@example.com"
set_var EASYRSA_REQ_OU         "MyOrgUnit"
set_var EASYRSA_KEY_SIZE       2048
set_var EASYRSA_ALGO           rsa
set_var EASYRSA_CA_EXPIRE      3650
set_var EASYRSA_CERT_EXPIRE    3650
set_var EASYRSA_NS_SUPPORT     "yes"
set_var EASYRSA_NS_COMMENT     "OpenVPN"

source ./vars
./clean-all
./build-ca
./build-key-server server
./build-dh
./build-key client
cp ~/openvpn-ca/keys/* /etc/openvpn/
systemctl start openvpn@server
systemctl enable openvpn@server






